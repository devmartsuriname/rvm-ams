# Restore Point: RP-P2B-pre-20260128

## Phase Reference
- **Project:** AMS–RVM Core (v1)
- **Phase:** 2B (Core Domain — Data Model Only)
- **Type:** Pre-Phase Checkpoint
- **Created:** 2026-01-28

---

## Database State (Before Phase 2B)

### Identity Schema (Phase 2 — Deployed)
| Table | Status |
|-------|--------|
| `app_user` | Deployed |
| `app_role` | Deployed (9 RVM roles seeded) |
| `user_role` | Deployed |
| `super_admin_bootstrap` | Deployed |

### RLS Helper Functions (Phase 2 — Deployed)
| Function | Status |
|----------|--------|
| `get_current_user_id()` | Deployed |
| `get_user_roles()` | Deployed |
| `has_role()` | Deployed |
| `has_any_role()` | Deployed |
| `is_super_admin()` | Deployed |

### Domain Schema (Phase 2B — NOT YET Deployed)
| Component | Status |
|-----------|--------|
| Enums | NOT Deployed |
| Domain Tables | NOT Deployed |
| Domain Indexes | NOT Deployed |

---

## Codebase State

### Auth Configuration
| Component | Status |
|-----------|--------|
| Fake Backend | Disabled |
| Dev Bypass Shim | Active (`_AMS_RVM_DEV_MODE_`) |
| Supabase Client | Configured |

### Files (No Changes in Phase 2B)
- No frontend modifications planned
- No UI changes planned
- Darkone template parity: 1:1

---

## Restoration Instructions

To restore to this point:
1. Drop all Phase 2B domain tables (if created)
2. Drop all Phase 2B enums (if created)
3. Phase 2 identity schema remains intact
4. No codebase changes required

### Rollback SQL (if needed)
```sql
-- Drop domain tables (reverse order of creation)
DROP TABLE IF EXISTS audit_event CASCADE;
DROP TABLE IF EXISTS rvm_task CASCADE;
DROP TABLE IF EXISTS rvm_document_version CASCADE;
DROP TABLE IF EXISTS rvm_document CASCADE;
DROP TABLE IF EXISTS rvm_decision CASCADE;
DROP TABLE IF EXISTS rvm_agenda_item CASCADE;
DROP TABLE IF EXISTS rvm_meeting CASCADE;
DROP TABLE IF EXISTS rvm_item CASCADE;
DROP TABLE IF EXISTS rvm_dossier CASCADE;
DROP TABLE IF EXISTS missive_keyword CASCADE;

-- Drop sequence
DROP SEQUENCE IF EXISTS dossier_number_seq;

-- Drop enums
DROP TYPE IF EXISTS confidentiality_level CASCADE;
DROP TYPE IF EXISTS task_type CASCADE;
DROP TYPE IF EXISTS task_priority CASCADE;
DROP TYPE IF EXISTS task_status CASCADE;
DROP TYPE IF EXISTS document_type CASCADE;
DROP TYPE IF EXISTS decision_status CASCADE;
DROP TYPE IF EXISTS agenda_item_status CASCADE;
DROP TYPE IF EXISTS meeting_status CASCADE;
DROP TYPE IF EXISTS meeting_type CASCADE;
DROP TYPE IF EXISTS dossier_status CASCADE;
DROP TYPE IF EXISTS urgency_level CASCADE;
DROP TYPE IF EXISTS proposal_subtype CASCADE;
DROP TYPE IF EXISTS service_type CASCADE;
```

---

## Notes
- Pre-phase checkpoint before domain schema deployment
- Phase 2 identity schema is stable and unaffected
- All Phase 2B changes are additive (no modifications to existing objects)
